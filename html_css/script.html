<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projet Propagande et Désinformation</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="../images/logo.png" type="image/png">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
</head>
<body>
    <nav class="navbar is-light" role="navigation" aria-label="main navigation">
        
        <!-- Bouton Hamburger -->
        <button class="navbar-toggler btn btn-outline-light" type="button" data-toggle="collapse" data-target="#navbarResponsive2" aria-controls="navbarResponsive2" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Contenu du menu -->
        <div class="collapse" id="navbarResponsive2">
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                <li class="nav-item"><a class="nav-link" href="intro.html">Introduction</a></li>
                <li class="nav-item"><a class="nav-link" href="script.html">Scripts</a></li>
                <li class="nav-item"><a class="nav-link" href="analyse.html">Analyse</a></li>
                <!-- Menu déroulant pour Tableaux -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Tableaux
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="../tableaux/tableau_fr.html">Français</a>
                        <a class="dropdown-item" href="../tableaux/tableau_en.html">Anglais</a>
                        <a class="dropdown-item" href="../tableaux/tableau_zh.html">Chinois</a>
                    </div>
                </li>
            </ul>
        </div>
        


        <!-- Contenu du menu -->
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <div class="logo">
                <a href="../index.html">
                    <img src="../images/logo.png" width="auto">
                </a>
            </div>
            <div class="navbar-menu">
                <div class="navbar-start">
                    <a class="navbar-item" href="./intro.html">Introduction</a>
                    <a class="navbar-item" href="./script.html">Scripts</a>
                    <a class="navbar-item" href="./analyse.html">Analyse</a>
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a class="navbar-item">Tableaux</a>
                        <div class="navbar-dropdown">
                            <a class="navbar-item sub" href="../tableaux/tableau_fr.html">
                                Français
                            </a>
                            <a class="navbar-item sub" href="../tableaux/tableau_en.html">
                                Anglais
                            </a>
                            <a class="navbar-item sub" href="../tableaux/tableau_zh.html">
                                Chinois
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="navbar-end">
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-item" href="./equipe.html">À propos</a>
                </div>
                <div class="navbar-item">
                    <a href="https://github.com/PetX33/Desinformation-Projet">
                        <img src="../images/github_blanc.png" alt="Github">
                    </a>
                </div>
            </div>
        </div>
    </nav>


    <main>
        <section class="corps">
            <section class="section nav_int">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link menu" href="#URL" style="font-size: 16px;">Traitement des URLs</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link menu" href="#Concordances" style="font-size: 16px;">Concordances</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link menu" href="#Tokenisation" style="font-size: 16px;">Tokenisation du chinois</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link menu" href="#Nuage" style="font-size: 16px;">Nuage de Mots</a>
                    </li>
                    <div>
                        <ul class="nav flex-column" style="padding-left: 20px;">
                            <li class="nav-item">
                                <a class="nav-link menu" href="#anglais" style="font-size: 16px;">Anglais</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link menu" href="#chinois" style="font-size: 16px;">Chinois</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link menu" href="#français" style="font-size: 16px;">Français</a>
                            </li>
                        </ul>
                    </div>
                </ul>
            </section>
            <section class="section texte_block">
                <div class="container" style="padding-left: 100px;">
                    <div class="columns" style="border-left: 5px; border-left-style: double; border-left-color: #428CB5; width: 90%;">
                        <div class="columnis-one-fifth" style="margin-left: 100px !important;">
                            <h1 class="intro has-text-centered" >Scripts</h1>
                            <h2 class="title has-text-centered" id="URL" style="color:#428CB5">1. Traitement des URLs</h2>
                            <p class="block">Ce programme nous permet de traiter toutes les urls d'un fichier afin de réaliser un tableau comportant les liens, des informations sur ceux-ci, les dumps des liens et les contextes et concordances (pour cela il fait appel au script concordance.sh).</p>
                            <div class="scrollable">
<pre><code>
<span><span class="green">#!/usr/bin/env bash</span></span>
<span></span>
<span><span class="green"># Call from the root folder with: sh ./scripts/traitement_url.sh &lt;language&gt; ./urls/&lt;file_urls&gt; ./tableaux/&lt;file_table&gt;</span></span>
<span></span>
<span></span>
<span><span class="green"># Check if exactly three arguments are provided</span></span>
<span><span class="blue">if</span> [ <span class="orange">$#</span> -ne 3 ];</span>
<span><span class="blue">then</span></span>
<span><span class="blue">echo</span> <span class="grey">"Trois arguments attendu exactement"</span>
<span><span class="blue">exit</span></span>
<span><span class="blue">fi</span></span>
<span></span>
<span><span class="green"># Check if the second argument is a file that exists</span></span>
<span><span class="blue">if</span> [ -f <span class="orange">$2</span> ]</span>
<span><span class="blue">then</span></span>
<span>	<span class="blue">echo</span><span class="grey">"On a bien un fichier"</span></span>
<span>else</span>
<span>	<span class="blue">echo</span><span class="grey">"On attend un fichier qui existe"</span></span>
<span>	exit</span>
<span><span class="blue">fi</span></span>
<span></span>
<span><span class="green"># Check if ggrep is available, otherwise use grep</span></span>
<span><span class="blue">if</span> command -v ggrep &gt; /dev/null;</span> 
<span class="blue">then</span>
<span>    GREP_CMD=<span class="grey">"ggrep"</span></span>
<span>else</span>
<span>    GREP_CMD=<span class="grey">"grep"</span></span>
<span><span class="blue">fi</span></span>
<span></span>
<span></span>
<span><span class="blue">if</span> command -v gsed &gt; /dev/null; then</span>
<span>    SED_CMD=<span class="grey">"gsed"</span></span>
<span>else</span>
<span>    SED_CMD=<span class="grey">"sed"</span></span>
<span><span class="blue">fi</span></span>
<span></span>
<span><span class="green"># Assigning command line arguments to variables</span></span>
<span>lang=<span class="orange">$1</span> <span class="green"># fr, en, zh</span></span>
<span>fichier_urls=<span class="orange">$2</span> <span class="green"># URL file</span></span>
<span>fichier_tableau=<span class="orange">$3</span> <span class="green"># Table file</span></span>
<span></span>
<span><span class="green"># Extracting the base name from fichier_urls</span></span>
<span>basename=<span class="red">$(basename -s .txt <span class="orange">$fichier_urls</span>)</span></span>
<span>lineno=1</span>
<span></span>
<span><span class="green"># Setting up the keyword(s) based on the provided language</span></span>
<span><span class="blue">if</span> [ "<span class="orange">$lang</span>" = 'zh' ]</span>
<span><span class="blue">then</span></span>
<span>	mot=<span class="grey">"虚假信息|政治宣传"</span></span>
<span>	export LANG=C</span>
<span><span class="blue">elif</span> [ "<span class="orange">$lang</span>" = 'en' ]</span>
<span><span class="blue">then</span></span>
<span> 	mot=<span class="grey">"([Dd]isinformation|[Pp]ropaganda)"</span></span>
<span><span class="blue">elif</span> [ "<span class="orange">$lang</span>" = 'fr' ]</span>
<span><span class="blue">then</span></span>
<span>	mot=<span class="grey">"([Dd]ésinformation|[Pp]ropagande)"</span></span>
<span><span class="blue">fi</span></span>
<span></span>
<span class="green"># Starting HTML output for URL table</span></span>
<span class="blue">echo</span> <span class="grey">"&lt;html&gt;</span>
<span class="grey">	&lt;head&gt;</span>
<span class="grey">		&lt;meta charset=\"UTF-8\"/&gt;</span>
<span class="grey">		&lt;link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css\"&gt;</span>
<span class="grey">		&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;</span>
<span class="grey">		&lt;title&gt;Tableau des URLS <span class="orange">$basename</span>&lt;/title&gt;</span>
<span class="grey">		&lt;link rel=\"stylesheet\" href=\"../html_css/style.css\"&gt;</span>
<span class="grey">		&lt;link rel=\"icon\" type=\"image/png\" href=\"../images/logo.png\"&gt;</span>
<span class="grey">		&lt;script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"&gt;&lt;/script&gt;</span>
<span class="grey">		&lt;script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"&gt;&lt;/script&gt;</span>
<span class="grey">		&lt;script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"&gt;&lt;/script&gt;</span>
<span class="grey">	&lt;/head&gt;</span>
<span class="grey">	&lt;body class=\"has-navbar-fixed-top\"&gt;</span>
<span class="grey">	&lt;nav class=\"navbar is-light\" role=\"navigation\" aria-label=\"main navigation\"&gt;</span>
<span class="grey">    	&lt;div class=\"collapse navbar-collapse\" id=\"navbarResponsive\"&gt;&lt;div class=\"logo\"&gt;&lt;a href=\"index.html\"&gt;&lt;img src=\"../images/logo.png\" width=\"auto\"&gt;&lt;/a&gt;&lt;/div&gt;&lt;div class=\"navbar-menu\"&gt;&lt;div class=\"navbar-start\"&gt;&lt;a class=\"navbar-item\" href=\"../html_css/intro.html\"&gt;Introduction&lt;/a&gt;&lt;a class=\"navbar-item\" href=\"./script.html\"&gt;Scripts&lt;/a&gt;&lt;a class=\"navbar-item\" href=\"./analyse.html\"&gt;Analyse&lt;/a&gt;&lt;div class=\"navbar-item has-dropdown is-hoverable\"&gt;&lt;a class=\"navbar-item\"&gt;Tableaux&lt;/a&gt;&lt;div class="navbar-dropdown"&gt;&lt;a class=\"navbar-item sub\" href=\"../tableaux/tableau_fr.html\"&gt;Français&lt;/a&gt;&lt;a class=\"navbar-item sub\" href=\"../tableaux/tableau_en.html\"&gt;Anglais&lt;/a&gt;&lt;a class=\"navbar-item sub\" href=\"../tableaux/tableau_zh.html\"&gt;Chinois&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
<span class="grey">		&lt;div class=\"navbar-end\"&gt;&lt;div class=\"navbar-item has-dropdown is-hoverable\"&gt;&lt;a class=\"navbar-item\" href=\"./equipe.html\"&gt;À propos&lt;/a&gt;&lt;/div&gt;&lt;div class=\"navbar-item\"&gt;&lt;a href=\"https://github.com/PetX33/Desinformation-Projet\"&gt;&lt;img src=\"../images/github_blanc.png\" alt=\"Github\"&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/nav&gt;"</span> &gt; "<span class="orange">$fichier_tableau</span>"</span>
<span></span>
<span class="blue">echo</span> <span class="grey">"		&lt;h1 class=\"title\" style=\"text-align: center; \"&gt;Tableau des URLs <span class="orange">$basename</span>&lt;/h1&gt;</span>
<span class="grey">		&lt;table class=\"table is-bordered is-bordered is-striped is-narrow is-hoverable\"&gt;</span>
<span class="grey">		&lt;thead style=\"background-color: #428cb5;\"&gt;&lt;tr&gt;&lt;th style=\" color: #ffffff\"&gt;ligne&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;code HTTP&lt;/th&gt;&lt;th style=\" color: #ffffff; text-align: center;\"&gt;URL&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;encodage&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;HTML&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;dump&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;occurrences&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;contextes&lt;/th&gt;&lt;th style=\" color: #ffffff\"&gt;concordances&lt;/th&gt;&lt;/thead&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span></span>
<span></span>
<span><span class="green"># If language is Chinese, set the environment language to C for correct character handling</span></span>
<span><span class="blue">if</span> [ "<span class="orange">$lang</span>" = "zh" ]</span>
<span><span class="blue">then</span></span>
<span></span>
<span>	<span class="green"># Read each URL from fichier_urls and process it</span></span>
<span class="blue">	while</span> read -r URL;</span>
<span class="blue">	do</span>
<span></span>
<span>		<span class="green"># HTTP response handling</span></span>
<span>		code=<span class="red">$(curl -ILs <span class="orange">$URL</span> | grep -e "^HTTP/" | grep -Eo "[0-9]{3}" | tail -n 1)</span>
<span></span>
<span>		<span class="green"># Charset detection and handling</span></span>
<span>		charset=<span class="red">$(curl -Ls <span class="orange">$URL</span> -D -o "./aspirations/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html" | grep -Eo "charset=(\w|-)+" | tail -n 1 | cut -d= -f2)</span></span>
<span></span>
<span>		<span class="green"># Process the URL's contents and save them in different formats</span></span>
<span>		<span class="blue">if</span> [ "<span class="orange">$code</span>" -eq 200 ]; <span class="blue">then</span>
<span>			result=<span class="grey">"OK"</span>
<span>		<span class="blue">else</span></span>
<span>			result=<span class="grey">"Not OK"</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="green"># If charset is not detected, set it to UTF-8</span></span>
<span>		<span class="blue">if</span> [ -z <span class="orange">$charset</span> ]</span>
<span>		<span class="blue">then</span></span>
<span>			<span class="grey">echo</span> -e <span class="grey">"\tencodage non détecté."</span>;</span>
<span>			charset=<span class="grey">"UTF-8"</span>;</span>
<span>		<span class="blue">else</span></span>
<span>			<span class="blue">echo</span> -e <span class="grey">"\tencodage : <span class="orange">$charset</span>"</span>;</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="blue">if</span> [ "<span class="orange">$URL</span>" = <span class="grey">"http://world.people.com.cn"*</span> ]</span>
<span>		<span class="blue">then</span></span>
<span>			charset=<span class="grey">"gb2312|GB2312"</span></span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="green"># Convert lowercase charset to uppercase</span></span>
<span>		charset=<span class="red">$(echo "<span class="orange">$charset</span>" | tr "[a-z]" "[A-Z]")</span></span>
<span></span>
<span>		<span class="blue">if</span> [ <span class="orange">$code</span> -eq 200 ]</span>
<span>		<span class="blue">then</span></span>
<span>			<span class="blue">if</span> [ "<span class="orange">$charset</span>" = 'UTF-8' ]</span>
<span>			<span class="blue">then</span></span>
<span>				dump=<span class="red">$(curl <span class="orange">$URL</span> | iconv -f UTF-8 -t UTF-8//IGNORE | lynx -stdin -accept_all_cookies -dump -nolist -assume_charset=utf-8 -display_charset=utf-8)</span></span>
<span>			<span class="blue">else</span></span>
<span>				dump=<span class="red">$(curl <span class="orange">$URL</span> | iconv -f GB2312 -t UTF-8 | lynx -stdin -accept_all_cookies -dump -nolist -assume_charset=utf-8 -display_charset=utf-8)</span></span>
<span>			<span class="blue">fi</span></span>
<span>		<span class="blue">else</span></span>
<span>			<span class="blue">echo</span> -e <span class="grey">"\tcode différent de 200 utilisation d'un dump vide"</span></span>
<span>			dump=""</span>
<span>			charset=""</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="blue">echo</span> <span class="grey">"<span class="orange">$dump</span>" &gt; "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span></span>
<span></span>
<span>		<span class="green"># Segment the text dump with the Chinese tokenizer thulac</span></span>
<span>		dumptok=<span class="red">$(python3 ./scripts/tokenize_chinese.py "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt")</span></span>
<span></span>
<span>		<span class="green"># Remove spaces between 虚假 and 信息 and 政治 and 宣传</span></span>
<span>		dumptok=<span class="grey">$(echo "<span class="orange">$dumptok</span>" | sed -e 's/虚假 信息/虚假信息/g' -e 's/政治 宣传/政治宣传/g')</span></span>
<span></span>
<span>		<span class="green"># Crushed the text dump with the Chinese tokenizer thulac</span></span>
<span>		<span class="blue">echo</span> "<span class="orange">$dumptok</span>" &gt; "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span>
<span></span>
<span>		<span class="green"># Count occurrences of the keyword in the text dump</span></span>
<span>		compte=<span class="red">$(grep -E -i -o "<span class="orange">$mot</span>" "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" | wc -l)</span></span>
<span>		<span class="blue">echo</span> "<span class="orange">$compte</span>"</span>
<span></span>
<span>		<span class="green"># Extract contexts of the keyword in the text dump</span></span>
<span>		grep -E -i -A 2 -B 2 "<span class="orange">$mot</span>" "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" &gt; "./contextes/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span>
<span></span>
<span>		<span class="green"># Generate concordance HTML file</span></span>
<span>		concordance=<span class="red">$(sh ./scripts/concordancier.sh <span class="orange">$lang</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" <span class="orange">$mot</span>)</span></span>
<span>		<span class="blue">echo</span> "<span class="orange">$concordance</span>" &gt; "./concordances/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"</span>
<span></span>
<span>		<span class="green"># Add a row to the HTML table for each URL</span></span>
<span>	<span class="blue">echo</span> "			&lt;tr&gt;&lt;td&gt;<span class="orange">$lineno</span>&lt;/td&gt;&lt;td&gt;<span class="orange">$code</span>&lt;/td&gt;&lt;td&gt;&lt;a href=\"<span class="orange">$URL</span>\"&gt;<span class="orange">$URL</span>&lt;/a&gt;&lt;/td&gt;&lt;td&gt;<span class="orange">$charset</span>&lt;/td&gt;&lt;td&gt;&lt;a href=\"../aspirations/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html\"&gt;html&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=\"../dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt\"&gt;text&lt;/a&gt;&lt;/td&gt;&lt;td&gt;<span class="orange">$compte</span>&lt;/td&gt;&lt;td&gt;&lt;a href=\"../contextes/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt\"&gt;contexte&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=\"../concordances/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html\"&gt;concordances&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span>
<span></span>
<span>		lineno=<span class="red">$((lineno +1))</span></span>
<span></span>
<span>	<span class="blue">done</span> &lt; "<span class="orange">$fichier_urls</span>"</span>
<span></span>
<span>	<span class="green"># Finish the HTML output</span></span>
<span><span class="blue">echo</span> "		&lt;/table&gt;</span>
<span>				&lt;footer&gt;</span>
<span>					&lt;p&gt;© 2023/2024 - Projet Propagande et Désinformation - MA Zhiya • PENG Yuanlong • QUENNEHEN Perrine&lt;/p&gt;</span>
<span>				&lt;/footer&gt;</span>
<span>		&lt;/body&gt;</span>
<span>	&lt;/html&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span>
<span></span>
<span></span>
<span><span class="blue">elif</span> [ "<span class="orange">$lang</span>" = "en" ]</span>
<span><span class="blue">then</span></span>
<span>	<span class="blue">while</span> read -r URL;</span>
<span>	<span class="blue">do</span></span>
<span>		<span class="green"># HTTP response handling</span></span>
<span>		code=<span class="red">$(curl -s -L -w "%{http_code}" -o ./aspirations/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html <span class="orange">$URL</span>)</span></span>
<span></span>
<span>		<span class="green"># Charset detection and handling</span></span>
<span>		charset=<span class="red">$(curl -s -I -L -w "%{content_type}" -o /dev/null <span class="orange">$URL</span> | <span class="orange">$GREP_CMD</span> -P -o "charset=\S+" | cut -d"=" -f2 | tail -n 1)</span></span>
<span></span>
<span>		<span class="green"># Process the URL's contents and save them in different formats</span></span>
<span>		<span class="green"># 200 OK</span></span>
<span>		<span class="blue">if</span> [ "<span class="orange">$code</span>" -eq 200 ]; <span class="blue">then</span></span>
<span>			result=<span class="grey">"OK"</span></span>
<span>		<span class="blue">else</span></span>
<span>			result=<span class="grey">"Not OK"</span></span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="green"># If charset is not detected, set it to UTF-8</span></span>
<span>		<span class="blue">if</span> [ -z <span class="orange">$charset</span> ]</span>
<span>		<span class="blue">then</span></span>
<span>		<span class="blue">echo</span> -e <span class="grey">"\tencodage non détecté."</span>;</span>
<span>			charset=<span class="grey">"UTF-8"</span>;</span>
<span>		<span class="blue">else</span></span>
<span>		<span class="blue">echo</span> -e <span class="grey">"\tencodage : <span class="orange">$charset</span>"</span>;</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="green"># Convert lowercase charset to uppercase</span></span>
<span>		charset=<span class="red">$(echo <span class="orange">$charset</span> | tr "[a-z]" "[A-Z]")</span>
<span></span>
<span></span>
<span>		<span class="blue">if</span> [ <span class="orange">$code</span> -eq 200 ]</span>
<span>		<span class="blue">then</span></span>
<span>			<span class="green"># If charset is UTF-8, use iconv to convert to UTF-8</span></span>
<span>			<span class="blue">if</span> [ "<span class="orange">$charset</span>" = 'UTF-8' ]</span>
<span>			<span class="blue">then</span></span>
<span>				dump=<span class="red">$(curl <span class="orange">$URL</span> | iconv -f UTF-8 -t UTF-8//IGNORE | lynx -stdin  -accept_all_cookies -dump -nolist -assume_charset=utf-8 -display_charset=utf-8 | <span class="orange">$SED_CMD</span> -E '/(BUTTON)/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)[+([o*_©►]/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)http/d' | <span class="orange">$SED_CMD</span> -E "/^(\s*)IFRAME/d" | <span class="orange">$SED_CMD</span> -E "/^(\s*)Ad Feedback/d")</span>
<span>			<span class="green"># Otherwise, use the detected charset</span></span>
<span>			<span class="blue">else</span></span>
<span>				dump=<span class="red">$(curl <span class="orange">$URL</span> | iconv -f <span class="orange">$charset</span> -t UTF-8//IGNORE | lynx -stdin  -accept_all_cookies -dump -nolist -assume_charset=utf-8 -display_charset=utf-8 | <span class="orange">$SED_CMD</span> -E '/(BUTTON)/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)[+([o*_©►]/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)http/d' | <span class="orange">$SED_CMD</span> -E "/^(\s*)IFRAME/d" | <span class="orange">$SED_CMD</span> -E "/^(\s*)Ad Feedback/d")</span>
<span>			<span class="blue">fi</span></span>
<span>		<span class="blue">else</span></span>
<span>		<span class="blue">echo</span> -e "\tcode différent de 200 utilisation d'un dump vide"</span>
<span>			dump=""</span>
<span>			charset=""</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span></span>
<span>		<span class="green"># Write the dump to a text file</span></span>
<span>	    <span class="blue">echo</span> "<span class="orange">$dump</span>" &gt; "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span>
<span></span>
<span>		<span class="green"># Count occurrences of the keyword in the text dump</span></span>
<span>		compte=<span class="red">$(grep -E -i -o <span class="orange">$mot</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" | wc -l)</span>
<span></span>
<span>		<span class="green"># Extract contexts of the keyword in the text dump</span></span>
<span>		grep -E -i -C 3 <span class="orange">$mot</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" &gt; "./contextes/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span>
<span></span>
<span>		<span class="green"># Generate concordance HTML file</span></span>
<span>		<span class="purple">sh</span> ./scripts/concordancier.sh <span class="orange">$lang</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" <span class="orange">$mot</span> &gt; "./concordances/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"</span>
<span></span>
<span>		<span class="green"># Add a row to the HTML table for each URL</span></span>
<span>	<span class="blue">echo</span> "			&lt;tr&gt;&lt;td&gt;<span class="orange">$lineno</span>&lt;/td&gt;&lt;td&gt;<span class="orange">$code</span>&lt;/td&gt;&lt;td&gt;&lt;a href=\"<span class="orange">$URL</span>\"&gt;<span class="orange">$URL</span>&lt;/a&gt;&lt;/td&gt;&lt;td&gt;<span class="orange">$charset</span>&lt;/td&gt;&lt;td&gt;&lt;a href="../aspirations/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"&gt;html&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href="../dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"&gt;text&lt;/a&gt;&lt;/td&gt;&lt;td&gt;<span class="orange">$compte</span>&lt;/td&gt;&lt;td&gt;&lt;a href="../contextes/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"&gt;contexte&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href="../concordances/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"&gt;concordances&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span>
<span></span>
<span>    	lineno=<span class="red">$((lineno + 1))</span>
<span>	<span class="blue">done</span> &lt; "<span class="orange">$fichier_urls</span>"</span>
<span></span>
<span>	<span class="green"># Finish the HTML output</span></span>
<span><span class="blue">echo</span> "		&lt;/table&gt;</span>
<span>				&lt;footer&gt;</span>
<span>       				&lt;p&gt;© 2023/2024 - Projet Propagande et Désinformation - MA Zhiya • PENG Yuanlong • QUENNEHEN Perrine&lt;/p&gt;</span>
<span>    			&lt;/footer&gt;</span>
<span>		&lt;/body&gt;</span>
<span>	&lt;/html&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span>
<span></span>
<span><span class="blue">else</span></span>
<span>	<span class="blue">while</span> read -r URL;</span>
<span>	<span class="blue">do</span></span>
<span>		<span class="green"># HTTP response handling</span></span>
<span>		code=<span class="red">$(curl -s -L -w "%{http_code}" -o ./aspirations/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html <span class="orange">$URL</span>)</span>
<span></span>
<span>		<span class="green"># Charset detection and handling</span></span>
<span>		charset=<span class="red">$(curl -s -I -L -w "%{content_type}" -o /dev/null <span class="orange">$URL</span> | <span class="orange">$GREP_CMD</span> -P -o "charset=\S+" | cut -d"=" -f2 | tail -n 1)</span>
<span></span>
<span>		<span class="green"># Process the URL's contents and save them in different formats</span></span>
<span>		<span class="green"># 200 OK</span></span>
<span>		<span class="blue">if</span> [ "<span class="orange">$code</span>" -eq 200 ]; <span class="blue">then</span></span>
<span>			result=<span class="grey">"OK"</span></span>
<span>		<span class="blue">else</span></span>
<span>			result=<span class="grey">"Not OK"</span></span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="green"># If charset is not detected, set it to UTF-8</span></span>
<span>		<span class="blue">if</span> [ -z <span class="orange">$charset</span> ]</span>
<span>		<span class="blue">then</span></span>
<span>		<span class="blue">echo</span> -e "\tencodage non détecté.";</span>
<span>			charset=<span class="grey">"UTF-8";</span></span>
<span>		<span class="blue">else</span></span>
<span>		<span class="blue">echo</span> -e <span class="grey">"\tencodage : <span class="orange">$charset</span>"</span>;</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span>		<span class="green"># Convert lowercase charset to uppercase</span></span>
<span>		charset=<span class="red">$(echo <span class="orange">$charset</span> | tr "[a-z]" "[A-Z]")</span>
<span></span>
<span></span>
<span>		<span class="blue">if</span> [ <span class="orange">$code</span> -eq 200 ]</span>
<span>		<span class="blue">then</span></span>
<span>			<span class="green"># If charset is UTF-8, use iconv to convert to UTF-8</span></span>
<span>			<span class="blue">if</span> [ "<span class="orange">$charset</span>" = 'UTF-8' ]</span>
<span>			<span class="blue">then</span></span>
<span>				dump=<span class="red">$(curl <span class="orange">$URL</span> | iconv -f UTF-8 -t UTF-8 | lynx -stdin  -accept_all_cookies -dump -nolist -assume_charset=utf-8 -display_charset=utf-8 | <span class="orange">$SED_CMD</span> -E '/(BUTTON)/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)[+([o*_©►]/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)http/d' | <span class="orange">$SED_CMD</span> -E "/^(\s*)IFRAME/d" | <span class="orange">$SED_CMD</span> -E "/^(\s*)Ad Feedback/d")</span>
<span>			<span class="green"># Otherwise, use the detected charset</span></span>
<span>			<span class="blue">else</span></span>
<span>				dump=<span class="red">$(curl <span class="orange">$URL</span> | iconv -f <span class="orange">$charset</span> -t UTF-8 | lynx -stdin  -accept_all_cookies -dump -nolist -assume_charset=utf-8 -display_charset=utf-8 | <span class="orange">$SED_CMD</span> -E '/(BUTTON)/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)[+([o*_©►]/d' | <span class="orange">$SED_CMD</span> -E '/^(\s*)http/d' | <span class="orange">$SED_CMD</span> -E "/^(\s*)IFRAME/d" | <span class="orange">$SED_CMD</span> -E "/^(\s*)Ad Feedback/d")</span>
<span>			<span class="blue">fi</span></span>
<span>		<span class="blue">else</span></span>
<span>		<span class="blue">echo</span> -e "\tcode différent de 200 utilisation d'un dump vide"</span>
<span>			dump=""</span>
<span>			charset=""</span>
<span>		<span class="blue">fi</span></span>
<span></span>
<span></span>
<span>		<span class="green"># Write the dump to a text file</span></span>
<span>	<span class="blue">echo</span> "<span class="orange">$dump</span>" &gt; "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span>
<span></span>
<span>		<span class="green"># Count occurrences of the keyword in the text dump</span></span>
<span>		compte=<span class="red">$(grep -E -i -o <span class="orange">$mot</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" | wc -l)</span>
<span></span>
<span>		<span class="green"># Extract contexts of the keyword in the text dump</span></span>
<span>		grep -E -i -C 3 <span class="orange">$mot</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" &gt; "./contextes/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"</span>
<span></span>
<span>		<span class="green"># Generate concordance HTML file</span></span>
<span>		<span class="purple">sh</span> ./scripts/concordancier.sh <span class="orange">$lang</span> "./dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt" <span class="orange">$mot</span> &gt; "./concordances/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"</span>
<span></span>
<span>		<span class="green"># Add a row to the HTML table for each URL</span></span>
<span>	<span class="blue">echo</span> "			&lt;tr&gt;&lt;td&gt;<span class="orange">$lineno</span>&lt;/td&gt;&lt;td&gt;<span class="orange">$code</span>&lt;/td&gt;&lt;td&gt;&lt;a href=\"<span class="orange">$URL</span>\"&gt;<span class="orange">$URL</span>&lt;/a&gt;&lt;/td&gt;&lt;td&gt;<span class="orange">$charset</span>&lt;/td&gt;&lt;td&gt;&lt;a href="../aspirations/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"&gt;html&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href="../dumps-text/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"&gt;text&lt;/a&gt;&lt;/td&gt;&lt;td&gt;<span class="orange">$compte</span>&lt;/td&gt;&lt;td&gt;&lt;a href="../contextes/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.txt"&gt;contexte&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href="../concordances/<span class="orange">$lang</span>/<span class="orange">$basename</span>-<span class="orange">$lineno</span>.html"&gt;concordances&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span>
<span></span>
<span>    	lineno=<span class="red">$((lineno + 1))</span>
<span>	<span class="blue">done</span> &lt; "<span class="orange">$fichier_urls</span>"</span>
<span></span>
<span>	<span class="green"># Finish the HTML output</span></span>
<span><span class="blue">echo</span> "		&lt;/table&gt;</span>
<span></span>
<span>			&lt;footer&gt;</span>
<span>				&lt;p&gt;© 2023/2024 - Projet Propagande et Désinformation - MA Zhiya • PENG Yuanlong • QUENNEHEN Perrine&lt;/p&gt;</span>
<span>			&lt;/footer&gt;</span>
<span>		&lt;/body&gt;</span>
<span>	&lt;/html&gt;" &gt;&gt; "<span class="orange">$fichier_tableau</span>"</span>
<span><span class="blue">fi</span></span>
<span></span>
</code></pre>
                            </div>
                            <h2 class="title has-text-centered" id="Concordances" style="color:#428CB5">2. Concordances</h2>
                            <p>Ce programme nous permet de générer les tableaux de concordances.</p>
                            <div class="scrollable">
<pre><code>
<span><span class="green">#!/usr/bin/env bash</span></span>
<span>&nbsp;</span>
<span><span class="green"># Assigning command line arguments to variables</span></span>
<span>lang=<span class="orange">$1</span> # Language code (fr, en, zh)</span>
<span>fichier_text=<span class="orange">$2</span> # File path</span>
<span>motif=<span class="orange">$3</span> # Pattern to search <span class="blue">for</span></span>
<span>&nbsp;</span>
<span><span class="green"># Check if exactly three arguments are provided</span></span>
<span><span class="blue">if</span> [ <span class="orange">$#</span> -ne 3 ]</span>
<span><span class="blue">then</span></span>
<span>	<span class="blue">echo</span> <span class="grey">"Ce programme demande exactement trois arguments."</span></span>
<span>	<span class="blue">echo</span> <span class="grey">"Usage : <span class="orange">$0</span> &lt;langue&gt; &lt;fichier&gt; &lt;motif&gt;"</span></span>
<span>	<span class="blue">exit</span></span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span><span class="green"># Check if the file exists</span></span>
<span><span class="blue">if</span> [ ! -f <span class="orange">$fichier_text</span> ]</span>
<span><span class="blue">then</span></span>
<span>  <span class="blue">echo</span> <span class="grey">"le fichier <span class="orange">$fichier_text</span> n'existe pas"</span></span>
<span> <span class="blue">exit</span></span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span><span class="green"># Check if the pattern is not empty</span></span>
<span><span class="blue">if</span> [ -z <span class="orange">$motif</span> ]</span>
<span><span class="blue">then</span></span>
<span>  <span class="blue">echo</span> <span class="grey">"le motif est vide"</span></span>
<span>  <span class="blue">exit</span></span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span><span class="green"># Check if the language is one of the specified options</span></span>
<span><span class="blue">if</span> [ "<span class="orange">$lang</span>" != "fr" ] &amp;&amp; [ "<span class="orange">$lang</span>" != "en" ] &amp;&amp; [ "<span class="orange">$lang</span>" != "zh" ]; <span class="blue">then</span></span>
<span>    <span class="blue">echo</span> <span class="grey">"La langue doit être fr, en ou zh"</span></span>
<span>    <span class="blue">exit</span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span><span class="green"># Determine the grep command to use based on system availability</span></span>
<span><span class="blue">if</span> command -v ggrep &gt; /dev/null; <span class="blue">then</span></span>
<span>    GREP_CMD="ggrep"</span>
<span>else</span>
<span>    GREP_CMD="grep"</span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span><span class="blue">if</span> command -v gsed &gt; /dev/null; <span class="blue">then</span></span>
<span>    SED_CMD="gsed"</span>
<span>else</span>
<span>    SED_CMD="sed"</span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span><span class="green"># Start of HTML output</span></span>
<span><span class="blue">echo</span> """</span>
<span>&lt;html&gt;</span>
<span>	&lt;head&gt;</span>
<span>		&lt;meta charset=\"UTF-8\"/&gt;</span>
<span>		&lt;link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css\"&gt;</span>
<span>		&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;</span>
<span>		&lt;title&gt;Tableau des concordances <span class="orange">$basename</span>&lt;/title&gt;</span>
<span>		&lt;link rel=\"stylesheet\" href=\"../../html_css/style.css\"&gt;</span>
<span>		&lt;link rel=\"icon\" type=\"image/png\" href=\"../../images/logo.png\"&gt;</span>
<span>		&lt;script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"&gt;&lt;/script&gt;</span>
<span>		&lt;script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"&gt;&lt;/script&gt;</span>
<span>		&lt;script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"&gt;&lt;/script&gt;</span>
<span>	&lt;/head&gt;</span>
<span>	&lt;body class=\"has-navbar-fixed-top\"&gt;</span>
<span>	&lt;nav class=\"navbar is-light\" role=\"navigation\" aria-label=\"main navigation\"&gt;</span>
<span>    	&lt;div class=\"collapse navbar-collapse\" id=\"navbarResponsive\"&gt;&lt;div class=\"logo\"&gt;&lt;a href=\"../../index.html\"&gt;&lt;img src=\"../../images/logo.png\" width=\"auto\"&gt;&lt;/a&gt;&lt;/div&gt;&lt;div class=\"navbar-menu\"&gt;&lt;div class=\"navbar-start\"&gt;&lt;a class=\"navbar-item\" href=\"../../html_css/intro.html\"&gt;Introduction&lt;/a&gt;&lt;a class=\"navbar-item\" href=\"./script.html\"&gt;Scripts&lt;/a&gt;&lt;a class=\"navbar-item\" href=\"./analyse.html\"&gt;Analyse&lt;/a&gt;&lt;div class=\"navbar-item has-dropdown is-hoverable\"&gt;&lt;a class=\"navbar-item\"&gt;Tableaux&lt;/a&gt;&lt;div class="navbar-dropdown"&gt;&lt;a class=\"navbar-item sub\" href=\"../../tableaux/tableau_fr.html\"&gt;Français&lt;/a&gt;&lt;a class=\"navbar-item sub\" href=\"../../tableaux/tableau_en.html\"&gt;Anglais&lt;/a&gt;&lt;a class=\"navbar-item sub\" href=\"../../tableaux/tableau_zh.html\"&gt;Chinois&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
<span>		&lt;div class=\"navbar-end\"&gt;&lt;div class=\"navbar-item has-dropdown is-hoverable\"&gt;&lt;a class=\"navbar-item\" href=\"./equipe.html\"&gt;À propos&lt;/a&gt;&lt;/div&gt;&lt;div class=\"navbar-item\"&gt;&lt;a href=\"https://github.com/PetX33/Desinformation-Projet\"&gt;&lt;img src=\"../../images/github_blanc.png\" alt=\"Github\"&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/nav&gt;</span>
<span>        &lt;!-- Title --&gt;</span>
<span>            &lt;h1 class=\"title\" style=\"text-align: center; \"&gt;Concordance&lt;/h1&gt;</span>
<span>            &lt;!-- Concordance table --&gt;</span>
<span>            &lt;table class=\"table is-bordered is-striped is-narrow is-hoverable is-fullwidth\"&gt;</span>
<span>                &lt;thead style=\"background-color: #428cb5;\"&gt;</span>
<span>                    &lt;tr&gt;</span>
<span>                        &lt;th class=\"has-text-right\" style=\" color: #ffffff\"&gt;Contexte gauche&lt;/th&gt;</span>
<span>                        &lt;th style=\" color: #ffffff\"&gt;Cible&lt;/th&gt;</span>
<span>                        &lt;th class=\"has-text-left\" style=\" color: #ffffff\"&gt;Contexte droit&lt;/th&gt;</span>
<span>                    &lt;/tr&gt;</span>
<span>                &lt;/thead&gt;</span>
<span>                &lt;tbody&gt;</span>
<span>"""</span>
<span>&nbsp;</span>
<span><span class="green"># Search pattern logic for Chinese language</span></span>
<span><span class="blue">if</span> [ "<span class="orange">$lang</span>" = 'zh' ]</span>
<span><span class="blue">then</span></span>
<span><span class="green">    # Export the LANG variable for Chinese</span></span>
<span>    export LANG=zh_CN.UTF-8</span>
<span>    <span class="orange">$GREP_CMD</span> -Po "(?:\p{Han}{1,}\s){0,5}(虚假信息|政治宣传)(\s\p{Han}{1,}){0,5}" "<span class="orange">$fichier_text</span>" | LANG=C <span class="orange">$SED_CMD</span> -E -r "s/(.*)(虚假信息|政治宣传)(.*)/&lt;tr&gt;&lt;td class=\"has-text-right\"&gt;\1&lt;\/td&gt;&lt;td class=\"has-text-danger\"&gt;\2&lt;\/td&gt;&lt;td class=\"has-text-left\"&gt;\3&lt;\/td&gt;&lt;\/tr&gt;/"</span>
<span>&nbsp;</span>
<span><span class="green"># Search pattern logic for other languages</span></span>
<span><span class="blue">else</span></span>
<span>    grep -E -o -i "(\w+\W+){0,5}<span class="orange">$motif</span>(\W+\w+){0,5}" <span class="orange">$fichier_text</span> | sed -E -r "s/(.*)<span class="orange">$motif</span>(.*)/&lt;tr&gt;&lt;td class=\"has-text-right\"&gt;\1&lt;\/td&gt;&lt;td class=\"has-text-danger\"&gt;\2&lt;\/td&gt;&lt;td class=\"has-text-left\"&gt;\3&lt;\/td&gt;&lt;\/tr&gt;/"</span>
<span><span class="blue">fi</span></span>
<span>&nbsp;</span>
<span><span class="green"># End of HTML output</span></span>
<span><span class="blue">echo</span> "</span>
<span>                &lt;/tbody&gt;</span>
<span>            &lt;/table&gt;</span>
<span>&nbsp;</span>
<span>            &lt;footer&gt;</span>
<span>                &lt;p&gt;© 2021 - Projet Propagande et Désinformation - MA Zhiya • PENG Yuanlong • QUENNEHEN Perrine&lt;/p&gt;</span>
<span>            &lt;/footer&gt;</span>
<span>        &lt;/body&gt;</span>
<span>&lt;/html&gt;</span>
<span>"</span>
</code></pre>
                            </div>
                            <h2 class="title has-text-centered" id="Tokenisation" style="color:#428CB5">3. Tokenisation du chinois</h2>
                            <p>Ce programme nous permet de tokeniser (mettre des espaces entre les mots) les fichiers en chinois afin de pouvoir les traiter par la suite.</p>
                            <div class="scrollable">
<pre><code>
<span><span class="green">#!/usr/bin/env python3</span></span>
<span>&nbsp;</span>
<span><span class="blue">import</span> thulac</span>
<span><span class="blue">import</span> errno</span>
<span><span class="blue">import</span> fileinput</span>
<span>&nbsp;</span>
<span><span class="green"># utilisation : python3 tokenize_chinese.py chinois.txt</span></span>
<span><span class="green"># possibilité de rediriger la sortie avec &gt;, &gt;&gt;</span></span>
<span>&nbsp;</span>
<span><span class="green"># autre possibilité, lancer la commande:</span></span>
<span><span class="green"># python3 -m thulac chinois.txt chinois_seg_output.txt -seg_only</span></span>
<span><span class="green"># Mais ne permet pas les redirections d'entrées/sorties</span></span>
<span>&nbsp;</span>
<span>seg = thulac.thulac(<span class="orange">seg_only</span>=<span class="purple">True</span>)</span>
<span><span class="blue">try:</span>
<span>	<span class="blue">for</span> line <span class="blue">in</span> fileinput.input():</span>
<span>		print(<span class="orange">seg.cut</span>(line, <span class="orange">text</span>=<span class="purple">True</span>))</span>
<span><span class="blue">except</span> IOError <span class="blue">as</span> e:</span>
<span>	<span class="blue">if</span> e.errno != errno.<span class="purple">EPIPE</span>:</span>
<span>		raise</span>
</code></pre>
                            </div>
                            <h2 class="title has-text-centered" id="Nuage" style="color:#428CB5">4. Nuage de Mots</h2>
                            <p>Ces programmes permettent de générer un nuage de mot pour chacune des langues.</p>
                            <br><h6 id="anglais">Pour l'anglais</h6>
                            <div class="scrollable">
<pre><code>
<span><span class="blue">from</span> os <span class="blue">import</span> path</span>
<span><span class="blue">from</span> PIL <span class="blue">import</span> Image</span>
<span><span class="blue">import</span> numpy <span class="blue">as</span> np</span>
<span><span class="blue">import</span> matplotlib.pyplot <span class="blue">as</span> plt</span>
<span><span class="blue">import</span> os</span>
<span><span class="blue">import</span> nltk</span>
<span><span class="blue">from</span> nltk.corpus <span class="blue">import</span> stopwords <span class="blue">as</span> nltk_stopwords</span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span><span class="green"># Download NLTK stopwords dataset if not already downloaded</span></span>
<span>nltk.download('stopwords')</span>
<span>&nbsp;</span>
<span><span class="green"># Current working directory</span></span>
<span>d = os.getcwd()</span>
<span>&nbsp;</span>
<span><span class="green"># Path to the directory containing text files</span></span>
<span>text_dir = path.join(d, <span class="orange">'../dumps-text/en/'</span>)</span>
<span>&nbsp;</span>
<span><span class="green"># Read all text files from the directory and concatenate their contents</span></span>
<span>all_text = ''</span>
<span><span class="blue">for</span> filename <span class="blue">in</span> os.listdir(text_dir):</span>
<span>    <span class="blue">if</span> filename.endswith(<span class="orange">'.txt'</span>):</span>
<span>        with open(path.join(text_dir, filename), 'r') <span class="blue">as</span> file:</span>
<span>            all_text += file.read() + ' '</span>
<span>&nbsp;</span>
<span><span class="green"># Read and format the mask image</span></span>
<span>usa_mask = np.array(Image.open(path.join(d, <span class="grey">"../images/usa.png"</span>)))</span>
<span>&nbsp;</span>
<span><span class="green"># Get French stopwords from NLTK</span></span>
<span>en_stopwords = set(nltk_stopwords.words(<span class="orange">'english'</span>))</span>
<span>en_stopwords.add('said')  # Add custom stopwords</span>
<span>&nbsp;</span>
<span><span class="green"># Create a WordCloud instance with adjusted settings</span></span>
<span>wc = WordCloud(background_color="white", max_words=<span class="purple">100</span>, mask=<span class="purple">usa_mask</span>,</span>
<span>               stopwords=<span class="purple">en_stopwords</span>, contour_width=<span class="purple">1</span>, contour_color='steelblue',</span>
<span>               scale=<span class="purple">3</span>)  
<span>&nbsp;</span>
<span><span class="green"># Generate word cloud</span></span>
<span>wc.generate(all_text)</span>
<span>&nbsp;</span>
<span><span class="green"># Save the generated word cloud to a new file</span></span>
<span>wc.to_file(path.join(d, <span class="grey">"../images/usa_wordcloud.png"</span>))</span>
<span>&nbsp;</span>
<span><span class="green"># Display the word cloud</span></span>
<span>plt.imshow(wc, interpolation='bilinear')</span>
<span>plt.axis("off")</span>
<span>plt.figure()</span>
<span>plt.imshow(usa_mask, cmap=<span class="purple">plt.cm.gray</span>, interpolation='bilinear')</span>
<span>plt.axis("off")</span>
<span>plt.show()</span>
</code></pre>
                            </div>
                            <br><h6 id="chinois">Pour le chinois</h6>
                            <div class="scrollable">
<pre><code>
<span><span class="blue">from</span> os <span class="blue">import</span> path</span>
<span><span class="blue">from</span> PIL <span class="blue">import</span> Image</span>
<span><span class="blue">import</span> numpy <span class="blue">as</span> np</span>
<span><span class="blue">import</span> matplotlib.pyplot <span class="blue">as</span> plt</span>
<span><span class="blue">import</span> os</span>
<span><span class="blue">import</span> jieba</span>
<span><span class="blue">import</span> re</span>
<span><span class="blue">from</span> wordcloud <span class="blue">import</span> WordCloud, STOPWORDS</span>
<span><span class="blue">from</span> stopwordsiso <span class="blue">import</span> stopwords</span>
<span>&nbsp;</span>
<span><span class="green"># Function to check if a word consists only of Latin letters</span></span>
<span><span class="blue">def</span> is_latin_word(word):</span>
<span>    return re.match("^([A-Za-z]|[0-9])+$", word)</span>
<span>&nbsp;</span>
<span><span class="green"># Current working directory</span></span>
<span>d = os.getcwd()</span>
<span>&nbsp;</span>
<span><span class="green"># Path to the directory containing text files</span></span>
<span>text_dir = path.join(d, <span class="orange">'../dumps-text/zh/'</span>)</span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span><span class="green"># Read all text files from the directory and concatenate their contents</span></span>
<span>all_text = ''</span>
<span><span class="blue">for</span> filename <span class="blue">in</span> os.listdir(text_dir):</span>
<span>    <span class="blue">if</span> filename.endswith(<span class="orange">'.txt'</span>):</span>
<span>        with open(path.join(text_dir, filename), 'r', encoding='utf-8') <span class="blue">as</span> file:</span>
<span>            all_text += file.read() + ' '</span>
<span>&nbsp;</span>
<span>segmented_text = list(jieba.cut(all_text))</span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span><span class="green"># Initialize stopwords</span></span>
<span>stopwords_zh = stopwords(<span class="orange">"zh"</span>)</span>
<span><span class="green"># Add any specific stopwords if needed</span></span>
<span>&nbsp;</span>
<span><span class="green"># Add Latin-letter words to stopwords</span></span>
<span><span class="blue">for</span> word <span class="blue">in</span> segmented_text:</span>
<span>    <span class="blue">if</span> is_latin_word(word):</span>
<span>        stopwords_zh.add(word)</span>
<span>&nbsp;</span>
<span><span class="green"># Regenerate the segmented text as a string</span></span>
<span>all_text = " ".join(segmented_text)</span>
<span>&nbsp;</span>
<span><span class="green"># Read and format the mask image</span></span>
<span>china_mask = np.array(Image.open(path.join(d, <span class="grey">"../images/china.png"</span>)))</span>
<span>&nbsp;</span>
<span><span class="green"># Create a WordCloud instance with adjusted settings</span></span>
<span>wc = WordCloud(background_color="white", max_words=<span class="purple">100</span>, mask=<span class="purple">china_mask</span>,</span>
<span>               stopwords=<span class="purple">stopwords_zh</span>, contour_width=<span class="purple">1</span>, contour_color='steelblue',</span>
<span>               scale=<span class="purple">3</span>, font_path=<span class="orange">"/System/Library/Fonts/PingFang.ttc"</span>)  # Specify the path to a Chinese font</span>
<span>&nbsp;</span>
<span><span class="green"># Generate word cloud</span></span>
<span>wc.generate(all_text)</span>
<span>&nbsp;</span>
<span><span class="green"># Save the generated word cloud to a new file</span></span>
<span>wc.to_file(path.join(d, <span class="grey">"../images/china_wordcloud.png"</span>))</span>
<span>&nbsp;</span>
<span><span class="green"># Display the word cloud</span></span>
<span>plt.imshow(wc, interpolation='bilinear')</span>
<span>plt.axis("off")</span>
<span>plt.figure()</span>
<span>plt.imshow(china_mask, cmap=<span class="purple">plt.cm.gray</span>, interpolation='bilinear')</span>
<span>plt.axis("off")</span>
<span>plt.show()</span>
</code></pre>
                            </div>

                            <br><h6 id="francais">Pour le français</h6>
                            <div class="scrollable">
<pre><code>
<span><span class="blue">from</span> os <span class="blue">import</span> path</span>
<span><span class="blue">from</span> PIL <span class="blue">import</span> Image</span>
<span><span class="blue">import</span> numpy <span class="blue">as</span> np</span>
<span><span class="blue">import</span> matplotlib.pyplot <span class="blue">as</span> plt</span>
<span><span class="blue">import</span> os</span>
<span><span class="blue">from</span> wordcloud <span class="blue">import</span> WordCloud</span>
<span><span class="blue">import</span> nltk</span>
<span><span class="blue">from</span> nltk.corpus <span class="blue">import</span> stopwords <span class="blue">as</span> nltk_stopwords</span>
<span>&nbsp;</span>
<span><span class="green"># Download NLTK stopwords dataset if not already downloaded</span></span>
<span>nltk.download('stopwords')</span>
<span>&nbsp;</span>
<span><span class="green"># Current working directory</span></span>
<span>d = os.getcwd()</span>
<span>&nbsp;</span>
<span><span class="green"># Path to the directory containing text files</span></span>
<span>text_dir = path.join(d, <span class="orange">'../dumps-text/fr/'</span>)</span>
<span>&nbsp;</span>
<span><span class="green"># Read all text files from the directory and concatenate their contents</span></span>
<span>all_text = ''</span>
<span><span class="blue">for</span> filename <span class="blue">in</span> os.listdir(text_dir):</span>
<span>    <span class="blue">if</span> filename.endswith('.txt'):</span>
<span>        with open(path.join(text_dir, filename), 'r', encoding='utf-8', errors='ignore') <span class="blue">as</span> file:</span>
<span>            all_text += file.read() + ' '</span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span>&nbsp;</span>
<span><span class="green"># Read and format the mask image</span></span>
<span>france_mask = np.array(Image.open(path.join(d, "../images/france.png")))</span>
<span>&nbsp;</span>
<span><span class="green"># Get French stopwords from NLTK</span></span>
<span>french_stopwords = set(nltk_stopwords.words(<span class="orange">'french'</span>))</span>
<span>french_stopwords.add(<span class="orange">'a'</span>)  # Add custom stopwords</span>
<span>&nbsp;</span>
<span><span class="green"># Create a WordCloud instance with adjusted settings</span></span>
<span>wc = WordCloud(background_color="white", max_words=<span class="purple">100</span>, mask=<span class="purple">france_mask</span>,</span>
<span>               stopwords=<span class="purple">french_stopwords</span>, contour_width=<span class="purple">1</span>, contour_color='steelblue',</span>
<span>               scale=<span class="purple">3</span>) 
<span>&nbsp;</span>
<span><span class="green"># Generate word cloud</span></span>
<span>wc.generate(all_text)</span>
<span>&nbsp;</span>
<span><span class="green"># Save the generated word cloud to a new file</span></span>
<span>wc.to_file(path.join(d,<span class="grey">"../images/france_wordcloud.png"</span>))</span>
<span>&nbsp;</span>
<span><span class="green"># Display the word cloud</span></span>
<span>plt.imshow(wc, interpolation='bilinear')</span>
<span>plt.axis("off")</span>
<span>plt.figure()</span>
<span>plt.imshow(france_mask, cmap=<span class="purple">plt.cm.gray</span>, interpolation='bilinear')</span>
<span>plt.axis("off")</span>
<span>plt.show()</span>
</code></pre>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            </section>
        </section>


    </main>

    <footer>
        <p>© 2023/2024 - Projet Propagande et Désinformation - MA Zhiya • PENG Yuanlong • QUENNEHEN Perrine</p>
    </footer>

    <script src="java.js"></script>
</body>
</html>